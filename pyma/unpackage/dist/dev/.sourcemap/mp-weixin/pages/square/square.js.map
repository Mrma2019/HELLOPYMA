{"version":3,"file":"square.js","sources":["pages/square/square.vue","pages/square/square.vue?type=page"],"sourcesContent":["<template>\r\n\t<view class=\"content\">\r\n\t\t<!-- 头部 -->\r\n\t\t<view class=\"header flex-col\" :style=\"{transform: `translateY(${headerTranslate})`, opacity: opacity}\">\r\n\t\t\t<view class=\"avatar-wrapper\" :style=\"{height: systemInfo.navBarHeight + 'px'}\">\r\n\t\t\t\t<view class=\"line-item flex-row\" :style=\"{top: avatarTop + 'px'}\">\r\n\t\t\t\t\t<text class=\"iconfont\" @click=\"goBack\">&#xe620;</text>\r\n\t\t\t\t\t<image class=\"avatar-img\" :src=\"userInfo.avatarUrl\" mode=\"widthFix\"\r\n\t\t\t\t\t\t:style=\"{width: avatarWidth + 'px', height: avatarWidth + 'px'}\"></image>\r\n\t\t\t\t\t<text class=\"iconfont\">&#xe60f;</text>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"tap-bar border-box flex-row\">\r\n\t\t\t\t<view :class=\"['tap-item', 'border-box', index==currentTap ? 'active':'']\"\r\n\t\t\t\t\tv-for=\"item, index in pageInfo.tapList\" :key=\"index\" @click=\"switchTap(index)\"><text\r\n\t\t\t\t\t\tclass=\"text\">{{item.text}}</text></view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\r\n\t\t<swiper indicator-dots=\"{{false}}\" autoplay=\"{{false}}\" :current=\"currentTap\" :style=\"{height: '100vh'}\"\r\n\t\t\t@change=\"onChange\">\r\n\t\t\t<swiper-item v-for=\"item, index in pageInfo.tapList\" :key=\"index\">\r\n\t\t\t\t<scroll-view class=\"scroll-box\" scroll-y :style=\"{paddingTop: scrollPaddingTop + 'px'}\"\r\n\t\t\t\t\t@scroll=\"onScroll\">\r\n\t\t\t\t\t<view v-for=\"content, index in item.content\" :key=\"index\">\r\n\t\t\t\t\t\t{{content}}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</scroll-view>\r\n\t\t\t</swiper-item>\r\n\t\t</swiper>\r\n\t\t<view class=\"post-btn flex-row\" hover-class=\"post-btn__hover\">\r\n\t\t\t<text class=\"iconfont\">&#xe605;</text>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport systemStore from '@/store/systemStore.js';\r\n\timport userStore from '@/store/userStore';\r\n\timport getPageInfo from './index.js';\r\n\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tpageInfo: {},\r\n\t\t\t\theaderHeight: 0,\r\n\t\t\t\theaderTranslate: '0px',\r\n\t\t\t\tcurrentTap: 0,\r\n\t\t\t\t//scroll滚动\r\n\t\t\t\tscrollPaddingTop: 0,\r\n\t\t\t\tlastScrollTop: 0,\r\n\t\t\t\t//头部透明度\r\n\t\t\t\topacity: 1,\r\n\r\n\t\t\t\tavatarWidth: 30,\r\n\t\t\t\tavatarTop: 0,\r\n\t\t\t\ttapBarHeight: 0\r\n\t\t\t};\r\n\t\t},\r\n\t\tasync onLoad() {\r\n\t\t\tthis.pageInfo = await getPageInfo();\r\n\r\n\t\t\tconst query = uni.createSelectorQuery().in(this);\r\n\t\t\tquery.select('.tap-bar').boundingClientRect((res) => {\r\n\t\t\t\tthis.tapBarHeight = res.height;\r\n\r\n\t\t\t\tconst navBarHeight = systemStore.data.navBarHeight;\r\n\t\t\t\tthis.headerHeight = this.scrollPaddingTop = navBarHeight + this.tapBarHeight;\r\n\r\n\t\t\t\tthis.avatarTop = this.systemInfo.menuBottom - (this.systemInfo.menuHeight + this.avatarWidth) /\r\n\t\t\t\t\t2;\r\n\t\t\t}).exec();\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tonScroll(e) {\r\n\t\t\t\tconst current = Math.max(e.detail.scrollTop, 0);\r\n\t\t\t\tconst offset = Math.min(current, this.headerHeight);\r\n\t\t\t\t// 方向判断加阈值（避免抖动）\r\n\t\t\t\tconst minDelta = 1.5;\r\n\t\t\t\tconst delta = current - this.lastScrollTop;\r\n\t\t\t\tconst isScrollingDown = delta > minDelta;\r\n\t\t\t\tconst isScrollingUp = delta < -minDelta;\r\n\t\t\t\tif (isScrollingDown) {\r\n\t\t\t\t\tthis.headerTranslate = `-${offset}px`;\r\n\t\t\t\t\tthis.opacity = 1 - offset * 1.5 / this.headerHeight;\r\n\t\t\t\t} else if (isScrollingUp) {\r\n\t\t\t\t\tthis.headerTranslate = '0px';\r\n\t\t\t\t\tthis.opacity = 1;\r\n\t\t\t\t}\r\n\t\t\t\t// paddingTop 固定，不要动态减\r\n\t\t\t\tthis.scrollPaddingTop = this.headerHeight - offset * 1.05;\r\n\t\t\t\tthis.lastScrollTop = current;\r\n\t\t\t},\r\n\t\t\tswitchTap(index) {\r\n\t\t\t\tconsole.log('currentTap', index);\r\n\t\t\t\tthis.currentTap = index;\r\n\t\t\t},\r\n\t\t\tonChange(e) {\r\n\t\t\t\tconst index = e.detail.current;\r\n\t\t\t\tthis.currentTap = index;\r\n\t\t\t},\r\n\t\t\tgoBack() {\r\n\t\t\t\tuni.navigateBack();\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\tuserInfo() {\r\n\t\t\t\tconst data = userStore.data;\r\n\t\t\t\treturn {\r\n\t\t\t\t\tavatarUrl: data.avatarUrl\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tsystemInfo() {\r\n\t\t\t\tconst data = systemStore.data\r\n\r\n\t\t\t\tconst menuInfo = data.menuInfo;\r\n\t\t\t\tconst menuHeight = menuInfo.height;\r\n\t\t\t\tconst menuBottom = menuInfo.bottom;\r\n\r\n\t\t\t\tconst navBarHeight = data.navBarHeight;\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\tmenuHeight,\r\n\t\t\t\t\tmenuBottom,\r\n\t\t\t\t\tnavBarHeight\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t.header {\r\n\t\twidth: 100%;\r\n\t\tbackground-color: #fff;\r\n\t\tposition: fixed;\r\n\t\ttop: 0;\r\n\t\tz-index: 10;\r\n\t\ttransition: transform 0.25s linear, opacity 0.25s linear;\r\n\t\tborder-bottom: 1px solid #eee;\r\n\r\n\t\t.line-item {\r\n\t\t\tposition: relative;\r\n\t\t\twidth: 100%;\r\n\t\t\theight: max-content;\r\n\t\t\talign-items: center;\r\n\t\t\tcolor: $uni-color-primary;\r\n\r\n\t\t\t.iconfont {\r\n\t\t\t\tposition: relative;\r\n\t\t\t\tmargin-left: 25rpx;\r\n\t\t\t\tfont-size: 35rpx;\r\n\t\t\t\tfont-weight: bold;\r\n\t\t\t\tz-index: 10;\r\n\r\n\t\t\t\t&:nth-of-type(2) {\r\n\t\t\t\t\tmargin: 0;\r\n\t\t\t\t\tfont-size: 90rpx;\r\n\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\ttext-align: center;\r\n\t\t\t\t\tcolor: #000;\r\n\t\t\t\t\tz-index: 0;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.avatar-img {\r\n\t\t\tborder-radius: 50%;\r\n\t\t\tmargin-left: 20rpx;\r\n\t\t\tbox-shadow: 2px 2px 8px rgba(0, 0, 0, 0.5);\r\n\t\t\tborder: 1px solid #eee;\r\n\t\t}\r\n\r\n\t\t.tap-bar {\r\n\t\t\theight: 80rpx;\r\n\t\t\tcolor: $uni-color-primary;\r\n\t\t\tjustify-content: space-around;\r\n\t\t\talign-items: center;\r\n\t\t\tfont-size: 30rpx;\r\n\t\t\tfont-weight: bold;\r\n\r\n\t\t\t.tap-item {\r\n\t\t\t\theight: 100%;\r\n\t\t\t\tline-height: 80rpx;\r\n\t\t\t\ttext-align: center;\r\n\t\t\t\tpadding: 0 50rpx;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.active {\r\n\t\t\tborder-bottom: 6rpx solid $uni-color-primary;\r\n\t\t}\r\n\t}\r\n\r\n\t.scroll-box {\r\n\t\theight: 100vh;\r\n\t\tbox-sizing: border-box;\r\n\t\ttransition: padding 0.25s linear;\r\n\t\t/* 让 padding 过渡自然 */\r\n\t}\r\n\r\n\t.post-btn {\r\n\t\twidth: 100rpx;\r\n\t\theight: 100rpx;\r\n\t\tborder-radius: 50%;\r\n\t\tbackground-color: $uni-color-primary;\r\n\t\tposition: fixed;\r\n\t\tbottom: 120rpx;\r\n\t\tright: 50rpx;\r\n\t\tcolor: #fff;\r\n\t\tjustify-content: center;\r\n\t\talign-items: center;\r\n\t\tfont-size: 40rpx;\r\n\t\tbox-shadow: 0 2px 8px rgba(0, 0, 0, 0.5);\r\n\t\ttransition: transform 0.25s ease;\r\n\t}\r\n\r\n\t.post-btn__hover {\r\n\t\ttransform: scale(1.1);\r\n\t}\r\n</style>","import MiniProgramPage from '/Volumes/CPBA_X64FRE/文稿/HBuilderProjects/HelloPyma/pyma/pages/square/square.vue'\nwx.createPage(MiniProgramPage)"],"names":["getPageInfo","uni","systemStore","userStore"],"mappings":";;;;;AAyCC,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,UAAU,CAAE;AAAA,MACZ,cAAc;AAAA,MACd,iBAAiB;AAAA,MACjB,YAAY;AAAA;AAAA,MAEZ,kBAAkB;AAAA,MAClB,eAAe;AAAA;AAAA,MAEf,SAAS;AAAA,MAET,aAAa;AAAA,MACb,WAAW;AAAA,MACX,cAAc;AAAA;EAEf;AAAA,EACD,MAAM,SAAS;AACd,SAAK,WAAW,MAAMA,mBAAAA;AAEtB,UAAM,QAAQC,cAAAA,MAAI,oBAAqB,EAAC,GAAG,IAAI;AAC/C,UAAM,OAAO,UAAU,EAAE,mBAAmB,CAAC,QAAQ;AACpD,WAAK,eAAe,IAAI;AAExB,YAAM,eAAeC,kBAAAA,YAAY,KAAK;AACtC,WAAK,eAAe,KAAK,mBAAmB,eAAe,KAAK;AAEhE,WAAK,YAAY,KAAK,WAAW,cAAc,KAAK,WAAW,aAAa,KAAK,eAChF;AAAA,IACF,CAAC,EAAE,KAAI;AAAA,EACP;AAAA,EACD,SAAS;AAAA,IACR,SAAS,GAAG;AACX,YAAM,UAAU,KAAK,IAAI,EAAE,OAAO,WAAW,CAAC;AAC9C,YAAM,SAAS,KAAK,IAAI,SAAS,KAAK,YAAY;AAElD,YAAM,WAAW;AACjB,YAAM,QAAQ,UAAU,KAAK;AAC7B,YAAM,kBAAkB,QAAQ;AAChC,YAAM,gBAAgB,QAAQ,CAAC;AAC/B,UAAI,iBAAiB;AACpB,aAAK,kBAAkB,IAAI,MAAM;AACjC,aAAK,UAAU,IAAI,SAAS,MAAM,KAAK;AAAA,MACtC,WAAS,eAAe;AACzB,aAAK,kBAAkB;AACvB,aAAK,UAAU;AAAA,MAChB;AAEA,WAAK,mBAAmB,KAAK,eAAe,SAAS;AACrD,WAAK,gBAAgB;AAAA,IACrB;AAAA,IACD,UAAU,OAAO;AAChBD,oBAAY,MAAA,MAAA,OAAA,iCAAA,cAAc,KAAK;AAC/B,WAAK,aAAa;AAAA,IAClB;AAAA,IACD,SAAS,GAAG;AACX,YAAM,QAAQ,EAAE,OAAO;AACvB,WAAK,aAAa;AAAA,IAClB;AAAA,IACD,SAAS;AACRA,oBAAG,MAAC,aAAY;AAAA,IACjB;AAAA,EACA;AAAA,EACD,UAAU;AAAA,IACT,WAAW;AACV,YAAM,OAAOE,gBAAS,UAAC;AACvB,aAAO;AAAA,QACN,WAAW,KAAK;AAAA,MACjB;AAAA,IACA;AAAA,IACD,aAAa;AACZ,YAAM,OAAOD,kBAAAA,YAAY;AAEzB,YAAM,WAAW,KAAK;AACtB,YAAM,aAAa,SAAS;AAC5B,YAAM,aAAa,SAAS;AAE5B,YAAM,eAAe,KAAK;AAE1B,aAAO;AAAA,QACN;AAAA,QACA;AAAA,QACA;AAAA,MACD;AAAA,IACD;AAAA,EACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC9HF,GAAG,WAAW,eAAe;"}